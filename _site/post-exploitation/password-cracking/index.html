<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Password Cracking | Hacking Notes</title>
<meta name="generator" content="Jekyll v3.8.4" />
<meta property="og:title" content="Password Cracking" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Cryptography is a method of protecting information and communications through the use of codes, so that only those for whom the information is intended can read and process it." />
<meta property="og:description" content="Cryptography is a method of protecting information and communications through the use of codes, so that only those for whom the information is intended can read and process it." />
<link rel="canonical" href="http://0.0.0.0:4000/hackingnotes/post-exploitation/password-cracking/" />
<meta property="og:url" content="http://0.0.0.0:4000/hackingnotes/post-exploitation/password-cracking/" />
<meta property="og:site_name" content="Hacking Notes" />
<script type="application/ld+json">
{"description":"Cryptography is a method of protecting information and communications through the use of codes, so that only those for whom the information is intended can read and process it.","url":"http://0.0.0.0:4000/hackingnotes/post-exploitation/password-cracking/","@type":"Article","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://0.0.0.0:4000/hackingnotes/siteicon.png"}},"headline":"Password Cracking","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

		<link type="application/atom+xml" rel="alternate" href="http://0.0.0.0:4000/hackingnotes/feed.xml" title="Hacking Notes" />

		<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic|Open+Sans:400,400italic,600,600italic,700,700italic|Inconsolata:400,700">
		<link rel="stylesheet" href="/hackingnotes/css/main.css">
		<link rel="apple-touch-icon" href="/hackingnotes/apple-touch-icon.png">
		<link rel="icon" type="image/png" href="/hackingnotes/touch-icon.png" sizes="192x192">
		<link rel="icon" type="image/png" href="/hackingnotes/images/favicon.png">

		
	</head>

	<body>
		<header>
			<h1>
				<a href="/hackingnotes/"><img src="/hackingnotes/images/emblem.svg" width="40" height="40" alt="Hacking Notes logo"></a>
				Hacking Notes
				<button type="button" class="open-nav" id="open-nav"></button>
			</h1>

			<form action="/hackingnotes/search/" method="get">
				<input type="text" name="q" id="search-input" placeholder="Search" autofocus>
				<input type="submit" value="Search" style="display: none;">
			</form>

			<nav class="full-navigation">
				<ul>
					<li class="nav-item top-level ">
						
						<a href="/hackingnotes/">What is this?</a>
					</li>
				</ul>

				<ul>
					
					
						<li class="nav-item top-level ">
							
							<a href="/hackingnotes/active-directory/introduction/">Active Directory</a>
							<ul>
								
									<li class="nav-item "><a href="/hackingnotes/active-directory/introduction/">Basics</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/active-directory/domain-enumeration/">Domain Enumeration</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/active-directory/lateral-movement/">Lateral Movement</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/active-directory/domain-persistence/">Domain Persistence</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/active-directory/domain-privesc/">Domain Privilege Escalation</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/active-directory/cross-forest-attacks/">Cross Forest Attacks</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/active-directory/forest-persistence/">Forest Persistence</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/active-directory/ad-certificate-services/">Active Directory Certificate Services</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/active-directory/securing-ad/">Hardening Active Directory</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/active-directory/ad-attacks/">AD Attacks</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/hackingnotes/client-side-attacks/evil-pdf/">Client Side Attacks</a>
							<ul>
								
									<li class="nav-item "><a href="/hackingnotes/client-side-attacks/evil-pdf/">Evil PDF</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/client-side-attacks/microsoft-office-macros/">Microsoft Office Macros</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/client-side-attacks/html-application/">HTML Application (HTA)</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/hackingnotes/enumeration/host-discovery/">Enumeration</a>
							<ul>
								
									<li class="nav-item "><a href="/hackingnotes/enumeration/host-discovery/">Host Discovery</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/enumeration/dns-enumeration/">DNS Enumeration</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/enumeration/os-discovery/">OS Discovery</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/enumeration/port-scanning/">Port Scanning</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/enumeration/waf-evasion/">WAF Evasion</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/hackingnotes/exploiting/buffer-overflow/">Exploiting</a>
							<ul>
								
									<li class="nav-item "><a href="/hackingnotes/exploiting/buffer-overflow/">Buffer Overflow</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/exploiting/bof-windows/">Windows BoF 32bit</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/exploiting/bof-linux/">Linux BoF 32bit</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/hackingnotes/hacking-wifi/theory/">Hacking Wifi</a>
							<ul>
								
									<li class="nav-item "><a href="/hackingnotes/hacking-wifi/theory/">Theory</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/hacking-wifi/wep/">Hacking Wifi - WEP</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/hacking-wifi/wpa-wpa2-psk/">Hacking Wifi - WPA/WPA2 PSK</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/hacking-wifi/wpa-wpa2-peap-enterprise/">Hacking Wifi - WPA/WPA2 PEAP (Enterprise)</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/hackingnotes/other/hacking-aws/">Other</a>
							<ul>
								
									<li class="nav-item "><a href="/hackingnotes/other/hacking-aws/">Hacking AWS</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/other/hacking-with-powershell/">Hacking with PowerShell</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level current">
							
							<a href="/hackingnotes/post-exploitation/av-evasion/">Post Exploitation</a>
							<ul>
								
									<li class="nav-item "><a href="/hackingnotes/post-exploitation/av-evasion/">AV Evasion</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/post-exploitation/bypass-uac/">Bypass UAC</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/post-exploitation/get-credentials/">Gathering Credentials</a></li>
								
									<li class="nav-item current"><a href="/hackingnotes/post-exploitation/password-cracking/">Password Cracking</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/post-exploitation/port-forwarding/">Port Forwarding and Tunneling</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/post-exploitation/reverse-shell/">Reverse Shell</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/post-exploitation/transfering-files/">Transfering Files</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/post-exploitation/ata-evasion/">ATA Evasion</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/post-exploitation/bypass-applocker/">Bypass APPLocker</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/hackingnotes/privilege-escalation/linux-privesc/">Privilege Escalation</a>
							<ul>
								
									<li class="nav-item "><a href="/hackingnotes/privilege-escalation/linux-privesc/">Linux Privesc</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/privilege-escalation/windows-privesc/">Windows Privesc</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/privilege-escalation/run-commands-as/">Run Commands As</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/hackingnotes/reconnaissance/information-gathering/">Reconnaissance</a>
							<ul>
								
									<li class="nav-item "><a href="/hackingnotes/reconnaissance/information-gathering/">Information Gathering</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/hackingnotes/red-team/introduction/">Red Team</a>
							<ul>
								
									<li class="nav-item "><a href="/hackingnotes/red-team/introduction/">Introduction</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/red-team/opsec-infrastructure/">OPSEC Infrastructure</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/red-team/c2-cobaltstrike/">C2 - Cobalt Strike</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/red-team/host-reconnaissance/">Host Reconnaissance</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/red-team/host-persistence/">Host Persistence</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/red-team/host-privilege-escalation/">Host Privilege Escalation</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/red-team/lateral-movement/">Lateral Movement</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/red-team/credentials-and-user-impersonation/">Credentials & User Impersonation</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/red-team/kibana/">Kibana - The Security App</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/red-team/pivoting/">Pivoting</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/red-team/ms-sql-servers/">MS SQL Servers</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/red-team/data-protection-api/">Data Protection API (DPAPI)</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/red-team/laps/">Local Administrator Password Solution (LAPS)</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/red-team/microsoft-defender/">Microsoft Defender Antivirus</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/red-team/application-whitelisting/">Application Whitelisting</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/red-team/exfiltration/">Exfiltration</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/hackingnotes/services/ftp/">Services</a>
							<ul>
								
									<li class="nav-item "><a href="/hackingnotes/services/ftp/">PORT 21/tcp - FTP</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/services/ssh/">PORT 22/tcp - SSH</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/services/smtp/">PORT 25/tcp - SMTP</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/services/dns/">PORT 53/tcp - DNS</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/services/http/">PORT 80/tcp, 443/tcp - HTTP Server</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/services/rpcbind/">PORT 111/tcp - RPCBind</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/services/imap/">PORT 143/tcp, 993/tcp - IMAP</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/services/smb/">PORT 139/tcp, 445/tcp - SMB</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/services/snmp/">PORT 161/udp - SNMP</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/services/java-rmi/">PORT 1100/tcp - Java RMI</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/services/sql-server/">PORT 1433/tcp - Microsoft SQL Server</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/services/nfs/">PORT 2049/tcp - NFS</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/services/mysql/">PORT 3306/tcp - MySQL Server</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/services/rdp/">PORT 3389/tcp - RDP</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/hackingnotes/software/wordpress/">Software</a>
							<ul>
								
									<li class="nav-item "><a href="/hackingnotes/software/wordpress/">WordPress</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/software/drupal/">Drupal</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/software/tomcat/">Tomcat</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/software/jenkins/">Jenkins</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/software/pypi-server/">PyPI Server</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/software/owa-exchange/">OWA Exchange</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/hackingnotes/web/file-inclusion/">Web</a>
							<ul>
								
									<li class="nav-item "><a href="/hackingnotes/web/file-inclusion/">File Inclusion</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/web/login-panes/">Login Panes</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/web/sqli/">SQL Injection (SQLi)</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/web/nosqli/">NoSQL Injection (NoSQLi)</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/web/templates-injections/">Server Side Templates Injections (SSTI)</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/web/unrestricted-file-upload/">Unrestricted File Upload</a></li>
								
									<li class="nav-item "><a href="/hackingnotes/web/oauth-2.0-bypass/">OAuth 2.0 Bypass</a></li>
								
							</ul>
						</li>
					
				</ul>

				<ul>
					<li class="nav-item top-level ">
						
						<a href="/hackingnotes/changelog/">Change Log</a>
					</li>
				</ul>
			</nav>
		</header>

		<section class="main">
			<div class="page-header">
				<h2>Post Exploitation</h2>
				<h3>Password Cracking</h3>
			</div>
			<article class="content">
				<p>Cryptography is a method of protecting information and communications through the use of codes, so that only those for whom the information is intended can read and process it.</p>

<h1 id="hashing">Hashing</h1>

<h2 id="introduction"><strong>Introduction</strong></h2>

<p>A <em>hash</em> is a function that converts one value to another. <em>Hashing</em> data is a common practice in computer science and is used for several different purposes. Examples include cryptography, compression, checksum generation, and data indexing.</p>

<p>Hashing is a natural fit for cryptography because it masks the original data with another value. A hash function can be used to generate a value that can only be decoded by looking up the value from a hash table. The table may be an <a href="https://techterms.com/definition/array">array</a>, <a href="https://techterms.com/definition/database">database</a>, or other data structure. A good cryptographic hash function is non-invertible, meaning it <strong>cannot be reverse engineered.</strong></p>

<h2 id="password-cracking-attacks">Password Cracking Attacks</h2>

<p>In cryptanalysis and computer security, password cracking is the process of recovering passwords from data that has been stored in or transmitted by a computer system.</p>

<p><strong>Hashcat</strong> is one of the most powerful password cracking tools at the moment. First we need to fount which type of hash we are trying to crack, this <a href="https://hashcat.net/wiki/doku.php?id=example\_hashes">guide</a> contains all hash types that hashcat supports.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hashcat -a 0 -m mode passwd.hash wordlist
</code></pre></div></div>

<blockquote>
  <p><strong>Caution</strong>: In order to avoid false positives or false negatives <strong>never use –force</strong> parameter.</p>
</blockquote>

<p>Or you can use Google Colab to crack the hashes:</p>

<ul>
  <li><a href="https://github.com/mxrch/penglab">https://github.com/mxrch/penglab</a></li>
</ul>

<h3 id="rainbow-tables">Rainbow Tables</h3>

<p>A rainbow table works by doing a cryptanalysis very quickly and effectively. Unlike bruteforce attack, which works by calculating the hash function of every string present with them, calculating their hash value and then compare it with the one in the computer, at every step. A rainbow table attack eliminates this need by already computing hashes of the large set of available strings.</p>

<p>There are some online resources where has a rainbow table pre calculated for some hash types.</p>

<ul>
  <li><a href="https://crackstation.net">https://crackstation.net/</a></li>
  <li><a href="https://www.md5online.org/md5-decrypt.html">https://www.md5online.org/md5-decrypt.html</a></li>
  <li><a href="https://md5.gromweb.com">https://md5.gromweb.com/</a></li>
</ul>

<blockquote>
  <p><strong>Note</strong>: Some modern hashes such as bcrypt make use of <strong>salt</strong>, which prevents Rainbow Tables attacks.</p>
</blockquote>

<h3 id="dictionary-attack">Dictionary Attack</h3>

<p>In cryptanalysis and computer security, a dictionary attack is an attack using a restricted subset of a keyspace to defeat a cipher or authentication mechanism by trying to determine its decryption key or passphrase, sometimes trying thousands or millions of likely possibilities often obtained from lists of past security breaches.</p>

<p>Te most common dictionaries used for password cracking:</p>

<ul>
  <li>Rockyou: <a href="https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt">https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt</a></li>
  <li>Kaonashi: <a href="https://github.com/kaonashi-passwords/Kaonashi">https://github.com/kaonashi-passwords/Kaonashi</a></li>
  <li>SecLists: <a href="https://github.com/danielmiessler/SecLists">https://github.com/danielmiessler/SecLists</a></li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hashcat -a 0 -m mode passwd.hash wordlist
</code></pre></div></div>

<blockquote>
  <p><strong>Note</strong>: Hashcat <code class="highlighter-rouge">-a 0</code> parameter is used to perform a dictionary attack.</p>
</blockquote>

<h4 id="rules">Rules</h4>

<p>Typical password-enforcement rules are collected in some dictionaries, these types of rules generally require the use of upper and olwe-case characters, numbers and special characters.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hashcat -a 0 -m mode passwd.hash -r rules wordlist
</code></pre></div></div>

<blockquote>
  <p><strong>Note</strong>: Hashcat rules are located in <code class="highlighter-rouge">/usr/share/hashcat/rules/</code></p>
</blockquote>

<h4 id="selecting-a-correct-wordlist">Selecting a correct Wordlist</h4>

<p>We can use common wordlists like <code class="highlighter-rouge">rockyou.txt</code> or some from SecLists, but also we can create a custom one.</p>

<ul>
  <li><strong>Cewl</strong></li>
</ul>

<p><code class="highlighter-rouge">Cewl</code> gives us the opportunity to browse the website and manually add commonly-used termns and product names to our custom wordlists. Also we can select the minimum length of the passwords wit <code class="highlighter-rouge">-m</code> parameter.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cewl www.example.com -m 6 -2 wordlist.out
</code></pre></div></div>

<ul>
  <li><strong>kwprocessor</strong></li>
</ul>

<p><code class="highlighter-rouge">Kwprocessor</code> is an external utility from hashcat that generates key-walk passwords, which are  based on adjacent keys. Has three main componentes, the base characters which are the alphabet of the target language, the keyboard layout and the routes (directions to walk in).</p>

<p><a href="https://github.com/hashcat/kwprocessor">https://github.com/hashcat/kwprocessor</a></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kwp64.exe basechars\custom.base keymaps\es.keymap routes\2-to-10-max-3-direction-changes.route -o .\keywalk.txt
</code></pre></div></div>

<blockquote>
  <p><strong>Note</strong>: Some candidates could be generated multiples times.</p>
</blockquote>

<h3 id="combinator-attack">Combinator Attack</h3>

<p>The combinator attack combines the entries from two dictionaries into single-words. We can also aply a rule to each word on the left or right using the options <code class="highlighter-rouge">-j</code> and <code class="highlighter-rouge">-k</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hashcat -a 1 -m mode hash wordlist1 wordlist2 -j $- -k $!
</code></pre></div></div>

<blockquote>
  <p><strong>Note</strong>: Hashcat <code class="highlighter-rouge">-a 1</code> parameter is used to perform a combinator attack.</p>
</blockquote>

<h3 id="mask-attack">Mask Attack</h3>

<p>Mask attacks are similar to brute-force attacks given they try all combinations from a set of characters. With brute-force attacks, all possible characters that exist are tried. Mask attacks are more specific as the set of characters you try is reduced based on information you know.</p>

<blockquote>
  <p><strong>Note</strong>: Hashcat <code class="highlighter-rouge">-a 3</code> parameter is used to perform a mask attack.</p>
</blockquote>

<h4 id="hashcat-parameters">Hashcat Parameters</h4>

<ul>
  <li>Built-in charsets:</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   ?l = abcdefghijklmnopqrstuvwxyz

   ?u = ABCDEFGHIJKLMNOPQRSTUVWXYZ

   ?d = 0123456789

   ?s =  !"#$%&amp;'()*+,-./:;&lt;=&gt;?@[\]^_`{|}~

   ?a = ?l?u?d?s

   ?b = 0x00 - 0xff
</code></pre></div></div>

<ul>
  <li>Custom charsets:</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  -1,  --custom-charset1=CS          User-defined charsets

  -2,  --custom-charset2=CS          Example:

  -3,  --custom-charset3=CS          --custom-charset1=?dabcdef : sets charset ?1 to 0123456789abcdef

  -4,  --custom-charset4=CS          -2 mycharset.hcchr : sets charset ?2 to chars contained in file

Example:

-1 ?u -2 ?u?l?d -3 ?d
</code></pre></div></div>

<p>We can also use static strings as part of a mask.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Company?d
</code></pre></div></div>
<h4 id="running-the-attack">Running the Attack</h4>

<p>After running the command, the attack will start and you should get output similar to the following:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hashcat -a 3 -m mode -1 ?u -2 -?l?u?d -3 ?d  hash ?1?2?2?2?3?3?3
</code></pre></div></div>

<p>We can use the <code class="highlighter-rouge">--increment</code> parameter to go trhough all combinations and no only try passwords of the same length:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>?1
?1?2
?1?2?2
?1?2?2?2
?1?2?2?2?3
?1?2?2?2?3?3
?1?2?2?2?3?3?3
</code></pre></div></div>

<p>Command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hashcat -a 3 -m mode -1 ?u -2 -?l?u?d -3 ?d --increment hash ?1?2?2?2?3?3?3
</code></pre></div></div>
<h4 id="mask-files">Mask Files</h4>

<p>We can create a file with different masks.</p>

<blockquote>
  <p><strong>Note</strong>: We can specify custom chars at the beginning of the line with <code class="highlighter-rouge">,</code> as a separator.</p>
</blockquote>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>?d?s,?u?l?l?l?l?1
?d?s,?u?l?l?l?l?l?1
?d?s,?u?l?l?l?l?l?l?1
?d?s,?u?l?l?l?l?l?l?l?1
?d?s,?u?l?l?l?l?l?l?l?l?1
</code></pre></div></div>
<p>And finally run it:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hashcat -a 3 -m mode  hash mask.hcmask
</code></pre></div></div>
<h3 id="hybrid-attack">Hybrid Attack</h3>

<p>The hybrid attack is a combination of wordlists and mask attack.</p>

<blockquote>
  <p><strong>Note</strong>: Hashcat <code class="highlighter-rouge">-a 6</code> parameter is used to perform a hybrid attack where first come the wordlist and after the mask mode.</p>
</blockquote>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hashcat -a 6 -m mode hash wordlist ?d?d?d?d
# Password5555
</code></pre></div></div>
<blockquote>
  <p><strong>Note</strong>: Hashcat <code class="highlighter-rouge">-a 7</code> parameter it is also used for hybrid attacks but first comes the mask and after that the wordlists.</p>
</blockquote>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hashcat -a 7 -m mode hash ?d?d?d?d wordlist 
# 5555Password
</code></pre></div></div>

<h1 id="encryption">Encryption</h1>

<h2 id="introduction-1">Introduction</h2>

<p>The two main categories of Encryption are symmetric and asymmetric.</p>

<p><strong>Symmetric encryption</strong> uses the same key to encrypt and decrypt the data. Examples of Symmetric encryption are DES (Broken) and AES. These algorithms tend to be faster than asymmetric cryptography, and use smaller keys (128 or 256 bit keys are common for AES, DES keys are 56 bits long).</p>

<p><strong>Asymmetric encryption</strong> uses a pair of keys, one to encrypt and the other in the pair to decrypt. Examples are RSA and Elliptic Curve Cryptography. Normally these keys are referred to as a public key and a private key. Data encrypted with the private key can be decrypted with the public key, and vice versa. Your private key needs to be kept private, hence the name. Asymmetric encryption tends to be slower and uses larger keys, for example RSA typically uses 2048 to 4096 bit keys.</p>

<h2 id="cracking-ssh-private-key">Cracking SSH private key</h2>

<p>After getting the private ssh key protected with a passphrase, in order to obtain this passphrase we will need to convert that ssh key to john format, for that run ssh2john script:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python ssh2john id_rsa &gt; id_rsa.hash
</code></pre></div></div>

<p>And crack it with your fav list:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>john id_rsa.hash -wordlist=[wordlist]
</code></pre></div></div>

<h2 id="cracking-kdbx-keepass-files">Cracking KDBX (KeePass Files)</h2>

<p>First we need to convert our file to a hash.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python keepass2john file.kdbx &gt; kdbx.hash
</code></pre></div></div>

<p>And crack it with your fav list:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>john kdbx.hash -wordlist=[wordlist]
hashcat -a 0 -m 13400 kdbx.hash [wordlist]
</code></pre></div></div>

<h2 id="decrypting-openssl-enc-data-with-salted-password">Decrypting openssl enc data with salted password</h2>

<p>When we found some file like that:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ file file.enc
file.enc: openssl enc'd data with salted password
</code></pre></div></div>

<p>We can crack the password with <code class="highlighter-rouge">bruteforce-salted-openssl</code> specifying the digest and cipher (AES-256-CBC by default).</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bruteforce-salted-openssl -t 50 -f rockyou.txt -d &lt;digest&gt; file.enc -1
</code></pre></div></div>

<p>Finally we need to decrypt the file with the key obtained while bruteforcing.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl aes-256-cbc -d -in file.enc -out file.txt -k &lt;KEY&gt;
</code></pre></div></div>

<h2 id="ciphers-detection">Ciphers Detection</h2>

<p>There are many online tools that helps to detect which type of cipher is applied based on entropy.</p>

<ul>
  <li><a href="https://www.boxentriq.com/code-breaking/cipher-identifier">https://www.boxentriq.com/code-breaking/cipher-identifier</a></li>
</ul>

<p>Also there are a lot of online tools to decode or encode with different ciphers:</p>

<ul>
  <li><a href="https://www.dcode.fr">https://www.dcode.fr/</a></li>
  <li><a href="https://gchq.github.io/CyberChef/">https://gchq.github.io/CyberChef/</a></li>
</ul>

<blockquote>
  <p><strong>Note:</strong> quipqiup is a powerfull tool that solves simple subsitution ciphers.</p>

  <p><a href="https://quipqiup.com">https://quipqiup.com/</a></p>
</blockquote>

<h1 id="references">References:</h1>

<ul>
  <li><a href="https://techterms.com/definition/hash">https://techterms.com/definition/hash</a></li>
  <li><a href="https://www.abhizer.com/crack-ssh-with-john/">https://www.abhizer.com/crack-ssh-with-john/</a></li>
  <li><a href="https://www.geeksforgeeks.org/understanding-rainbow-table-attack/">https://www.geeksforgeeks.org/understanding-rainbow-table-attack/</a></li>
  <li><a href="https://www.4armed.com/blog/perform-mask-attack-hashcat/">https://www.4armed.com/blog/perform-mask-attack-hashcat/</a></li>
</ul>

			</article>
		</section>

		<script>
			document.getElementById("open-nav").addEventListener("click", function () {
				document.body.classList.toggle("nav-open");
			});
		</script>
	</body>
</html>
